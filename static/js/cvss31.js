"use strict";function updateScores(){var e=CVSS31.calculateCVSSFromMetrics(inputValue('input[type="radio"][name=AV]:checked'),inputValue('input[type="radio"][name=AC]:checked'),inputValue('input[type="radio"][name=PR]:checked'),inputValue('input[type="radio"][name=UI]:checked'),inputValue('input[type="radio"][name=S]:checked'),inputValue('input[type="radio"][name=C]:checked'),inputValue('input[type="radio"][name=I]:checked'),inputValue('input[type="radio"][name=A]:checked'),inputValue('input[type="radio"][name=E]:checked'),inputValue('input[type="radio"][name=RL]:checked'),inputValue('input[type="radio"][name=RC]:checked'),inputValue('input[type="radio"][name=CR]:checked'),inputValue('input[type="radio"][name=IR]:checked'),inputValue('input[type="radio"][name=AR]:checked'),inputValue('input[type="radio"][name=MAV]:checked'),inputValue('input[type="radio"][name=MAC]:checked'),inputValue('input[type="radio"][name=MPR]:checked'),inputValue('input[type="radio"][name=MUI]:checked'),inputValue('input[type="radio"][name=MS]:checked'),inputValue('input[type="radio"][name=MC]:checked'),inputValue('input[type="radio"][name=MI]:checked'),inputValue('input[type="radio"][name=MA]:checked'));if(!0===e.success){for(var t=(n=document.querySelectorAll(".needBaseMetrics")).length;t--;)hide(n[t]);parentNode(text("#baseMetricScore",e.baseMetricScore),".scoreRating").className="scoreRating "+e.baseSeverity.toLowerCase(),text("#baseSeverity","("+e.baseSeverity+")"),parentNode(text("#temporalMetricScore",e.temporalMetricScore),".scoreRating").className="scoreRating "+e.temporalSeverity.toLowerCase(),text("#temporalSeverity","("+e.temporalSeverity+")"),parentNode(text("#environmentalMetricScore",e.environmentalMetricScore),".scoreRating").className="scoreRating "+e.environmentalSeverity.toLowerCase(),text("#environmentalSeverity","("+e.environmentalSeverity+")"),show(inputValue("#vectorString",e.vectorString)),window.location.hash=e.vectorString}else if("Not all base metrics were given - cannot calculate scores."===e.error){for(var n,t=(n=document.querySelectorAll(".needBaseMetrics")).length;t--;)show(n[t]);hide("#vectorString")}}function delayedUpdateScores(){setTimeout(updateScores,100)}window.Element&&function(e){e.matchesSelector=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector||function(e){for(var t=this,n=(t.parentNode||t.document).querySelectorAll(e),i=-1;n[++i]&&n[i]!=t;);return!!n[i]}}(Element.prototype);var CVSSVectorInURL,matchesSelector=function(e,t){return!!("parentNode"in e&&e.parentNode)&&-1!=Array.prototype.indexOf.call(e.parentNode.querySelectorAll(t))};function node(){for(var e=0;e<arguments.length;e++){var t=arguments[e];if("string"==typeof t&&t)return document.querySelector(t);if("nodeName"in t)return t;if("jquery"in t)return t.get(0)}return!1}function parentNode(e,t){return(e=e&&node(e))?"string"==typeof t&&e.matchesSelector(t)||e==t?e:"html"!=e.nodeName.toLowerCase()?parentNode(e.parentNode,t):void 0:void 0}function bind(e,t,n){e=node(e);if(e)return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n,e}function text(e,t){e=node(e);if(e)return 1<arguments.length?("textContent"in e?e.textContent=t:e.innerText=t,e):e.textContent||e.innerText}function hide(e){e=node(e);if(e)return e.setAttribute("style","display:none"),e}function show(e){e=node(e);if(e)return e.setAttribute("style","display:inline-block"),e}function inputValue(e,t){e=document.querySelector(e);if(e&&"input"==e.nodeName.toLowerCase())return 1<arguments.length?(e.value=t,e):e.value}function setMetricsFromVector(e){var t=!0,n={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:"X",RL:"X",RC:"X",CR:"X",IR:"X",AR:"X",MAV:"X",MAC:"X",MPR:"X",MUI:"X",MS:"X",MC:"X",MI:"X",MA:"X"};if(/^CVSS:3.1\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/.test(e)){var i,r=e.substring("CVSS:3.1/".length).split("/");for(o in r)n[(i=r[o].split(":"))[0]]=i[1];if(void 0!==n.AV&&void 0!==n.AC&&void 0!==n.PR&&void 0!==n.UI&&void 0!==n.S&&void 0!==n.C&&void 0!==n.I&&void 0!==n.A)for(var o in n)document.getElementById(o+"_"+n[o]).checked=!0;else t="NotAllBaseMetricsProvided"}else t="MalformedVectorString";return updateScores(),t}function urlhash(){var e=window.location.hash;setMetricsFromVector((CVSSVectorInURL=e).substring(1))}function inputSelect(){this.setSelectionRange(0,this.value.length)}function cvssCalculator(){if("CVSS31"in window&&"CVSS31_Help"in window){for(var e,t=document.querySelectorAll(".cvss-calculator input"),n=t.length;n--;)bind(t[n],"click",delayedUpdateScores);for(e in CVSS31_Help.helpText_en)document.getElementById(e).setAttribute("title",CVSS31_Help.helpText_en[e]);urlhash(),"onhashchange"in window&&(window.onhashchange=urlhash),bind(bind("#vectorString","click",inputSelect),"contextmenu",inputSelect)}else setTimeout(cvssCalculator,100)}cvssCalculator();