var CVSS31={CVSSVersionIdentifier:"CVSS:3.1",exploitabilityCoefficient:8.22,scopeCoefficient:1.08,vectorStringRegex_31:/^CVSS:3\.1\/((AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])\/)*(AV:[NALP]|AC:[LH]|PR:[UNLH]|UI:[NR]|S:[UC]|[CIA]:[NLH]|E:[XUPFH]|RL:[XOTWU]|RC:[XURC]|[CIA]R:[XLMH]|MAV:[XNALP]|MAC:[XLH]|MPR:[XUNLH]|MUI:[XNR]|MS:[XUC]|M[CIA]:[XNLH])$/,Weight:{AV:{N:.85,A:.62,L:.55,P:.2},AC:{H:.44,L:.77},PR:{U:{N:.85,L:.62,H:.27},C:{N:.85,L:.68,H:.5}},UI:{N:.85,R:.62},S:{U:6.42,C:7.52},CIA:{N:0,L:.22,H:.56},E:{X:1,U:.91,P:.94,F:.97,H:1},RL:{X:1,O:.95,T:.96,W:.97,U:1},RC:{X:1,U:.92,R:.96,C:1},CIAR:{X:1,L:.5,M:1,H:1.5}},severityRatings:[{name:"None",bottom:0,top:0},{name:"Low",bottom:.1,top:3.9},{name:"Medium",bottom:4,top:6.9},{name:"High",bottom:7,top:8.9},{name:"Critical",bottom:9,top:10}],calculateCVSSFromMetrics:function(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X){var h,I,y,H,b,F,x,T,D,g,q,k,u,N,f,L,U,P,O,E,W,w=[];return void 0!==e&&""!==e||w.push("AV"),void 0!==i&&""!==i||w.push("AC"),void 0!==t&&""!==t||w.push("PR"),void 0!==r&&""!==r||w.push("UI"),void 0!==o&&""!==o||w.push("S"),void 0!==n&&""!==n||w.push("C"),void 0!==a&&""!==a||w.push("I"),void 0!==S&&""!==S||w.push("A"),0<w.length?{success:!1,errorType:"MissingBaseMetric",errorMetrics:w}:(i=i,t=t,r=r,o=o,n=n,a=a,S=S,_=_||"X",s=s||"X",C=C||"X",c=c||"X",M=M||"X",d=d||"X",p=p||"X",l=l||"X",v=v||"X",m=m||"X",V=V||"X",A=A||"X",R=R||"X",X=X||"X",CVSS31.Weight.AV.hasOwnProperty(e=e)||w.push("AV"),CVSS31.Weight.AC.hasOwnProperty(i)||w.push("AC"),CVSS31.Weight.PR.U.hasOwnProperty(t)||w.push("PR"),CVSS31.Weight.UI.hasOwnProperty(r)||w.push("UI"),CVSS31.Weight.S.hasOwnProperty(o)||w.push("S"),CVSS31.Weight.CIA.hasOwnProperty(n)||w.push("C"),CVSS31.Weight.CIA.hasOwnProperty(a)||w.push("I"),CVSS31.Weight.CIA.hasOwnProperty(S)||w.push("A"),CVSS31.Weight.E.hasOwnProperty(_)||w.push("E"),CVSS31.Weight.RL.hasOwnProperty(s)||w.push("RL"),CVSS31.Weight.RC.hasOwnProperty(C)||w.push("RC"),"X"===c||CVSS31.Weight.CIAR.hasOwnProperty(c)||w.push("CR"),"X"===M||CVSS31.Weight.CIAR.hasOwnProperty(M)||w.push("IR"),"X"===d||CVSS31.Weight.CIAR.hasOwnProperty(d)||w.push("AR"),"X"===p||CVSS31.Weight.AV.hasOwnProperty(p)||w.push("MAV"),"X"===l||CVSS31.Weight.AC.hasOwnProperty(l)||w.push("MAC"),"X"===v||CVSS31.Weight.PR.U.hasOwnProperty(v)||w.push("MPR"),"X"===m||CVSS31.Weight.UI.hasOwnProperty(m)||w.push("MUI"),"X"===V||CVSS31.Weight.S.hasOwnProperty(V)||w.push("MS"),"X"===A||CVSS31.Weight.CIA.hasOwnProperty(A)||w.push("MC"),"X"===R||CVSS31.Weight.CIA.hasOwnProperty(R)||w.push("MI"),"X"===X||CVSS31.Weight.CIA.hasOwnProperty(X)||w.push("MA"),0<w.length?{success:!1,errorType:"UnknownMetricValue",errorMetrics:w}:(w=CVSS31.Weight.AV[e],U=CVSS31.Weight.AC[i],P=CVSS31.Weight.PR[o][t],O=CVSS31.Weight.UI[r],L=CVSS31.Weight.S[o],u=CVSS31.Weight.CIA[n],N=CVSS31.Weight.CIA[a],f=CVSS31.Weight.CIA[S],h=CVSS31.Weight.E[_],I=CVSS31.Weight.RL[s],y=CVSS31.Weight.RC[C],W=CVSS31.Weight.CIAR[c],H=CVSS31.Weight.CIAR[M],b=CVSS31.Weight.CIAR[d],F=CVSS31.Weight.AV["X"!==p?p:e],x=CVSS31.Weight.AC["X"!==l?l:i],T=CVSS31.Weight.PR["X"!==V?V:o]["X"!==v?v:t],D=CVSS31.Weight.UI["X"!==m?m:r],g=CVSS31.Weight.S["X"!==V?V:o],E=CVSS31.Weight.CIA["X"!==A?A:n],q=CVSS31.Weight.CIA["X"!==R?R:a],k=CVSS31.Weight.CIA["X"!==X?X:S],u=1-(1-u)*(1-N)*(1-f),N="U"===o?L*u:L*(u-.029)-3.25*Math.pow(u-.02,15),f=CVSS31.exploitabilityCoefficient*w*U*P*O,L=N<=0?0:"U"===o?CVSS31.roundUp1(Math.min(f+N,10)):CVSS31.roundUp1(Math.min(CVSS31.scopeCoefficient*(f+N),10)),w=CVSS31.roundUp1(L*h*I*y),U=Math.min(1-(1-E*W)*(1-q*H)*(1-k*b),.915),P="U"===V||"X"===V&&"U"===o?g*U:g*(U-.029)-3.25*Math.pow(.9731*U-.02,13),O=CVSS31.exploitabilityCoefficient*F*x*T*D,E=P<=0?0:"U"===V||"X"===V&&"U"===o?CVSS31.roundUp1(CVSS31.roundUp1(Math.min(P+O,10))*h*I*y):CVSS31.roundUp1(CVSS31.roundUp1(Math.min(CVSS31.scopeCoefficient*(P+O),10))*h*I*y),W=CVSS31.CVSSVersionIdentifier+"/AV:"+e+"/AC:"+i+"/PR:"+t+"/UI:"+r+"/S:"+o+"/C:"+n+"/I:"+a+"/A:"+S,"X"!==_&&(W=W+"/E:"+_),"X"!==s&&(W=W+"/RL:"+s),"X"!==C&&(W=W+"/RC:"+C),"X"!==c&&(W=W+"/CR:"+c),"X"!==M&&(W=W+"/IR:"+M),"X"!==d&&(W=W+"/AR:"+d),"X"!==p&&(W=W+"/MAV:"+p),"X"!==l&&(W=W+"/MAC:"+l),"X"!==v&&(W=W+"/MPR:"+v),"X"!==m&&(W=W+"/MUI:"+m),"X"!==V&&(W=W+"/MS:"+V),"X"!==A&&(W=W+"/MC:"+A),"X"!==R&&(W=W+"/MI:"+R),"X"!==X&&(W=W+"/MA:"+X),{success:!0,baseMetricScore:L.toFixed(1),baseSeverity:CVSS31.severityRating(L.toFixed(1)),baseISS:u,baseImpact:N,baseExploitability:f,temporalMetricScore:w.toFixed(1),temporalSeverity:CVSS31.severityRating(w.toFixed(1)),environmentalMetricScore:E.toFixed(1),environmentalSeverity:CVSS31.severityRating(E.toFixed(1)),environmentalMISS:U,environmentalModifiedImpact:P,environmentalModifiedExploitability:O,vectorString:W}))},calculateCVSSFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS31.vectorStringRegex_31.test(e))return{success:!1,errorType:"MalformedVectorString"};var r,o,n=e.substring(CVSS31.CVSSVersionIdentifier.length).split("/");for(r in n)n.hasOwnProperty(r)&&(void 0===i[(o=n[r].split(":"))[0]]?i[o[0]]=o[1]:t.push(o[0]));return 0<t.length?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS31.calculateCVSSFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)},roundUp1:function(e){e=Math.round(1e5*e);return e%1e4==0?e/1e5:(Math.floor(e/1e4)+1)/10},severityRating:function(e){var i=CVSS31.severityRatings.length,t=Number(e);if(isNaN(t))return t;for(var r=0;r<i;r++)if(e>=CVSS31.severityRatings[r].bottom&&e<=CVSS31.severityRatings[r].top)return CVSS31.severityRatings[r].name},XML_MetricNames:{E:{X:"NOT_DEFINED",U:"UNPROVEN",P:"PROOF_OF_CONCEPT",F:"FUNCTIONAL",H:"HIGH"},RL:{X:"NOT_DEFINED",O:"OFFICIAL_FIX",T:"TEMPORARY_FIX",W:"WORKAROUND",U:"UNAVAILABLE"},RC:{X:"NOT_DEFINED",U:"UNKNOWN",R:"REASONABLE",C:"CONFIRMED"},CIAR:{X:"NOT_DEFINED",L:"LOW",M:"MEDIUM",H:"HIGH"},MAV:{N:"NETWORK",A:"ADJACENT_NETWORK",L:"LOCAL",P:"PHYSICAL",X:"NOT_DEFINED"},MAC:{H:"HIGH",L:"LOW",X:"NOT_DEFINED"},MPR:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"},MUI:{N:"NONE",R:"REQUIRED",X:"NOT_DEFINED"},MS:{U:"UNCHANGED",C:"CHANGED",X:"NOT_DEFINED"},MCIA:{N:"NONE",L:"LOW",H:"HIGH",X:"NOT_DEFINED"}},generateXMLFromMetrics:function(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X){var h=CVSS31.calculateCVSSFromMetrics(e,i,t,r,o,n,a,S,_,s,C,c,M,d,p,l,v,m,V,A,R,X);return!0!==h.success?h:{success:!0,xmlString:'<?xml version="1.0" encoding="UTF-8"?>\n<cvssv3.1 xmlns="https://www.first.org/cvss/cvss-v3.1.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xsi:schemaLocation="https://www.first.org/cvss/cvss-v3.1.xsd https://www.first.org/cvss/cvss-v3.1.xsd"\n  >\n\n  <base_metrics>\n    <attack-vector>__AttackVector__</attack-vector>\n    <attack-complexity>__AttackComplexity__</attack-complexity>\n    <privileges-required>__PrivilegesRequired__</privileges-required>\n    <user-interaction>__UserInteraction__</user-interaction>\n    <scope>__Scope__</scope>\n    <confidentiality-impact>__Confidentiality__</confidentiality-impact>\n    <integrity-impact>__Integrity__</integrity-impact>\n    <availability-impact>__Availability__</availability-impact>\n    <base-score>__BaseScore__</base-score>\n    <base-severity>__BaseSeverityRating__</base-severity>\n  </base_metrics>\n\n  <temporal_metrics>\n    <exploit-code-maturity>__ExploitCodeMaturity__</exploit-code-maturity>\n    <remediation-level>__RemediationLevel__</remediation-level>\n    <report-confidence>__ReportConfidence__</report-confidence>\n    <temporal-score>__TemporalScore__</temporal-score>\n    <temporal-severity>__TemporalSeverityRating__</temporal-severity>\n  </temporal_metrics>\n\n  <environmental_metrics>\n    <confidentiality-requirement>__ConfidentialityRequirement__</confidentiality-requirement>\n    <integrity-requirement>__IntegrityRequirement__</integrity-requirement>\n    <availability-requirement>__AvailabilityRequirement__</availability-requirement>\n    <modified-attack-vector>__ModifiedAttackVector__</modified-attack-vector>\n    <modified-attack-complexity>__ModifiedAttackComplexity__</modified-attack-complexity>\n    <modified-privileges-required>__ModifiedPrivilegesRequired__</modified-privileges-required>\n    <modified-user-interaction>__ModifiedUserInteraction__</modified-user-interaction>\n    <modified-scope>__ModifiedScope__</modified-scope>\n    <modified-confidentiality-impact>__ModifiedConfidentiality__</modified-confidentiality-impact>\n    <modified-integrity-impact>__ModifiedIntegrity__</modified-integrity-impact>\n    <modified-availability-impact>__ModifiedAvailability__</modified-availability-impact>\n    <environmental-score>__EnvironmentalScore__</environmental-score>\n    <environmental-severity>__EnvironmentalSeverityRating__</environmental-severity>\n  </environmental_metrics>\n\n</cvssv3.1>\n'.replace("__AttackVector__",CVSS31.XML_MetricNames.MAV[e]).replace("__AttackComplexity__",CVSS31.XML_MetricNames.MAC[i]).replace("__PrivilegesRequired__",CVSS31.XML_MetricNames.MPR[t]).replace("__UserInteraction__",CVSS31.XML_MetricNames.MUI[r]).replace("__Scope__",CVSS31.XML_MetricNames.MS[o]).replace("__Confidentiality__",CVSS31.XML_MetricNames.MCIA[n]).replace("__Integrity__",CVSS31.XML_MetricNames.MCIA[a]).replace("__Availability__",CVSS31.XML_MetricNames.MCIA[S]).replace("__BaseScore__",h.baseMetricScore).replace("__BaseSeverityRating__",h.baseSeverity).replace("__ExploitCodeMaturity__",CVSS31.XML_MetricNames.E[_||"X"]).replace("__RemediationLevel__",CVSS31.XML_MetricNames.RL[s||"X"]).replace("__ReportConfidence__",CVSS31.XML_MetricNames.RC[C||"X"]).replace("__TemporalScore__",h.temporalMetricScore).replace("__TemporalSeverityRating__",h.temporalSeverity).replace("__ConfidentialityRequirement__",CVSS31.XML_MetricNames.CIAR[c||"X"]).replace("__IntegrityRequirement__",CVSS31.XML_MetricNames.CIAR[M||"X"]).replace("__AvailabilityRequirement__",CVSS31.XML_MetricNames.CIAR[d||"X"]).replace("__ModifiedAttackVector__",CVSS31.XML_MetricNames.MAV[p||"X"]).replace("__ModifiedAttackComplexity__",CVSS31.XML_MetricNames.MAC[l||"X"]).replace("__ModifiedPrivilegesRequired__",CVSS31.XML_MetricNames.MPR[v||"X"]).replace("__ModifiedUserInteraction__",CVSS31.XML_MetricNames.MUI[m||"X"]).replace("__ModifiedScope__",CVSS31.XML_MetricNames.MS[V||"X"]).replace("__ModifiedConfidentiality__",CVSS31.XML_MetricNames.MCIA[A||"X"]).replace("__ModifiedIntegrity__",CVSS31.XML_MetricNames.MCIA[R||"X"]).replace("__ModifiedAvailability__",CVSS31.XML_MetricNames.MCIA[X||"X"]).replace("__EnvironmentalScore__",h.environmentalMetricScore).replace("__EnvironmentalSeverityRating__",h.environmentalSeverity)}},generateXMLFromVector:function(e){var i={AV:void 0,AC:void 0,PR:void 0,UI:void 0,S:void 0,C:void 0,I:void 0,A:void 0,E:void 0,RL:void 0,RC:void 0,CR:void 0,IR:void 0,AR:void 0,MAV:void 0,MAC:void 0,MPR:void 0,MUI:void 0,MS:void 0,MC:void 0,MI:void 0,MA:void 0},t=[];if(!CVSS31.vectorStringRegex_31.test(e))return{success:!1,errorType:"MalformedVectorString"};var r,o,n=e.substring(CVSS31.CVSSVersionIdentifier.length).split("/");for(r in n)n.hasOwnProperty(r)&&(void 0===i[(o=n[r].split(":"))[0]]?i[o[0]]=o[1]:t.push(o[0]));return 0<t.length?{success:!1,errorType:"MultipleDefinitionsOfMetric",errorMetrics:t}:CVSS31.generateXMLFromMetrics(i.AV,i.AC,i.PR,i.UI,i.S,i.C,i.I,i.A,i.E,i.RL,i.RC,i.CR,i.IR,i.AR,i.MAV,i.MAC,i.MPR,i.MUI,i.MS,i.MC,i.MI,i.MA)}};